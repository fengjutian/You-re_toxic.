<view class="container">
  <view class="notice">
    请根据<strong>过去两周</strong>的实际感受填写。
    本量表仅用于心理筛查，不作为医学诊断。
  </view>

  <block wx:for="{{questions}}" wx:key="index">
    <view class="card">
      <view class="question">
        {{index + 1}}. {{item}}
      </view>

      <radio-group data-index="{{index}}" bindchange="onSelect">
        <label wx:for="{{options}}" wx:key="value" class="option">
          <radio value="{{item.value}}" />
          {{item.label}}
        </label>
      </radio-group>
    </view>
  </block>

  <!-- 功能损害补充题 -->
  <view class="card">
    <view class="question">
      这些问题在工作、学习或人际交往中对你造成多大困难？
    </view>
    <radio-group bindchange="onImpactSelect">
      <label wx:for="{{impactOptions}}" wx:key="value" class="option">
        <radio value="{{item}}" /> {{item}}
      </label>
    </radio-group>
  </view>

  <button class="submit" bindtap="submit">查看结果</button>

  <view wx:if="{{result}}" class="result-card">
    <view class="result-header">
      <view class="result-title">测评结果</view>
    </view>

    <view class="score-section">
      <view class="score-label">总分</view>
      <view class="score-value">{{result.score}}</view>
      <view class="score-max">/ 27</view>
    </view>

    <view class="level-section">
      <view class="level-label">抑郁程度</view>
      <view class="level-text {{result.levelClass}}">{{result.level}}</view>
    </view>

    <view class="desc-section">
      <view class="section-title">专业解读</view>
      <view class="desc-text">{{result.desc}}</view>
    </view>

    <view class="tip-section">
      <view class="tip-label">💡 建议</view>
      <view class="tip-text">{{result.tip}}</view>
    </view>

    <view wx:if="{{result.clinicalInfo}}" class="clinical-note">
      <view class="clinical-icon">📊</view>
      <view class="clinical-text">
        <view class="clinical-title">临床筛查阈值</view>
        <view class="clinical-detail">{{result.clinicalInfo.note}}</view>
        <view class="clinical-stat">灵敏度、特异度均约 88%</view>
      </view>
    </view>

    <view wx:if="{{result.alert}}" class="alert-card">
      <view class="alert-icon">🚨</view>
      <view class="alert-text">
        <view class="alert-title">重要提示</view>
        <view class="alert-message">{{result.alert}}</view>
      </view>
    </view>
  </view>
</view>
